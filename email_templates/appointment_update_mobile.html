<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="format-detection" content="telephone=no">
    <meta name="format-detection" content="date=no">
    <meta name="format-detection" content="address=no">
    <meta name="format-detection" content="email=no">
    <title>עדכון תורים - BookGov</title>
    <!--[if mso]>
    <noscript>
        <xml>
            <o:OfficeDocumentSettings>
                <o:PixelsPerInch>96</o:PixelsPerInch>
            </o:OfficeDocumentSettings>
        </xml>
    </noscript>
    <![endif]-->
    <style>
        /* Reset styles for email clients */
        body, table, td, p, a, li, blockquote { -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; }
        table, td { mso-table-lspace: 0pt; mso-table-rspace: 0pt; }
        img { -ms-interpolation-mode: bicubic; border: 0; outline: none; text-decoration: none; }
        
        /* Mobile-first responsive design */
        @media only screen and (max-width: 600px) {
            .mobile-container { width: 100% !important; padding: 10px !important; }
            .mobile-header { padding: 20px 15px !important; font-size: 20px !important; }
            .mobile-content { padding: 20px 15px !important; }
            .mobile-table { font-size: 14px !important; }
            .mobile-table th, .mobile-table td { padding: 12px 8px !important; }
            .mobile-note { margin: 12px 15px 0 !important; font-size: 13px !important; }
            .mobile-footer { padding: 12px 15px !important; font-size: 11px !important; }
            .mobile-button { display: block !important; width: 100% !important; margin: 8px 0 !important; }
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            .dark-mode-text { color: #f8fafc !important; }
            .dark-mode-bg { background-color: #1f2937 !important; }
        }
    </style>
</head>
<body style="margin: 0; padding: 0; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); font-family: 'Heebo', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans Hebrew', 'Open Sans Hebrew', sans-serif; color: #f8fafc; min-height: 100vh; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;">
    
    <!-- Main Container -->
    <div class="mobile-container" style="max-width: 100%; margin: 0 auto; background: linear-gradient(135deg, #1f2937 0%, #111827 100%); min-height: 100vh;">
        
        <!-- Mobile-Optimized Header -->
        <div class="mobile-header" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%); padding: 30px 20px; color: white; text-align: center; font-weight: 800; font-size: 24px; letter-spacing: .5px; position: relative; overflow: hidden;">
            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent); opacity: 0.6;"></div>
            <div style="position: relative; z-index: 1;">
                תורים עבור חידוש דרכון ותעודת זהות
            </div>
        </div>

        <!-- Mobile-Optimized Note -->
        <div class="mobile-note" style="margin: 20px 20px 0; font-size: 14px; color: #fbbf24; font-weight: 600; text-align: center; background: rgba(251, 191, 36, 0.1); padding: 12px 16px; border-radius: 12px; border: 1px solid rgba(251, 191, 36, 0.3);">
            הערה: זהו מייל לא רשמי שאינו נשלח מטעם ממשלת ישראל
        </div>

        <!-- Mobile-Optimized Content -->
        <div class="mobile-content" style="padding: 25px 20px 30px;">
            
            <!-- Summary Card -->
            <div style="font-size: 16px; margin-bottom: 25px; color: #e2e8f0; background: rgba(59, 130, 246, 0.1); padding: 20px; border-radius: 12px; border-right: 4px solid #3b82f6; text-align: center;">
                נמצאו <strong style="color: #60a5fa; font-size: 18px;">{{ count }}</strong> תורים המתאימים להגדרות המסנן שבחרת
            </div>

            <!-- Mobile-Optimized Table -->
            <div class="mobile-table" style="width: 100%; margin-bottom: 25px;">
                <div style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: #ffffff; text-transform: uppercase; font-weight: 700; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3); border-radius: 12px 12px 0 0; padding: 16px; text-align: center; font-size: 14px;">
                    תורים זמינים
                </div>
                
                {% set ns = namespace(last_branch=None) %}
                {% for entry in entries %}
                    {% set is_first_for_branch = entry.branch_name != ns.last_branch %}
                    <div style="
                        background: {% if is_first_for_branch %}linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(37, 99, 235, 0.1) 100%){% else %}rgba(30, 41, 59, 0.8){% endif %};
                        margin: 8px 0;
                        border-radius: 12px;
                        border: 1px solid {% if is_first_for_branch %}rgba(59, 130, 246, 0.3){% else %}rgba(59, 130, 246, 0.1){% endif %};
                        overflow: hidden;
                        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                    ">
                        <div style="padding: 16px 20px; text-align: center;">
                            <div style="
                                color: {% if is_first_for_branch %}#60a5fa{% else %}#e2e8f0{% endif %};
                                font-weight: {% if is_first_for_branch %}700{% else %}400{% endif %};
                                font-size: 16px;
                                margin-bottom: 8px;
                                {% if is_first_for_branch %}border-bottom: 2px solid #3b82f6; padding-bottom: 8px;{% endif %}
                            ">
                                {{ entry.branch_name }}
                            </div>
                            <div style="
                                color: {% if is_first_for_branch %}#60a5fa{% else %}#e2e8f0{% endif %};
                                font-size: 15px;
                                {% if is_first_for_branch %}font-weight: 600;{% endif %}
                            ">
                                {{ entry.formatted_date }}
                            </div>
                        </div>
                    </div>
                    {% set ns.last_branch = entry.branch_name %}
                {% endfor %}
            </div>



            <!-- Mobile-Optimized Footer Info -->
            <div style="background: rgba(59, 130, 246, 0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(59, 130, 246, 0.2); text-align: center;">
                <p style="margin: 0 0 12px 0; font-size: 14px; color: #94a3b8;">
                    אתם רואים מייל זה מכיוון שנרשמתם ל
                    <a href="https://bookgov.onrender.com/" style="color: #60a5fa; font-weight: 600; text-decoration: none; border-bottom: 1px solid #60a5fa;">אתר</a>
                </p>
                <p style="margin: 0; font-size: 14px; color: #94a3b8;">
                    לביטול המנוי, בקר <a href="{{ unsubscribe_url }}" style="color: #60a5fa; font-weight: 600; text-decoration: none; border-bottom: 1px solid #60a5fa;">בכתובת</a> 
                </p>
            </div>
        </div>

        <!-- Mobile-Optimized Footer -->
        <div class="mobile-footer" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.05) 100%); text-align: center; padding: 20px; font-size: 12px; color: #64748b; border-top: 1px solid rgba(59, 130, 246, 0.2);">
            <div style="margin-bottom: 8px;">
                <span style="color: #60a5fa; font-weight: 600; font-size: 14px;">© BookGov</span>
            </div>
        </div>
    </div>
</body>
</html>
