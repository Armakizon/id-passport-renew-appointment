<div id="locationButtons" class="mb-3">
  <button id="getLocationBtn" class="btn btn-primary">
    ğŸ“ Based on My Location
  </button>
</div>

<script>
document.getElementById("getLocationBtn")?.addEventListener("click", (e) => {
  e.preventDefault(); // prevent form/button default behavior

  if (!navigator.geolocation) {
    alert("Geolocation is not supported by your browser.");
    return;
  }

  navigator.geolocation.getCurrentPosition(pos => {
    const userLat = pos.coords.latitude.toFixed(6);
    const userLon = pos.coords.longitude.toFixed(6);

    const allRows = document.querySelectorAll("#appointmentsTable tbody tr");

    allRows.forEach(row => {
      const rowLat = parseFloat(row.getAttribute("data-lat")).toFixed(6);
      const rowLon = parseFloat(row.getAttribute("data-lon")).toFixed(6);

      const matches = rowLat === userLat && rowLon === userLon;
      row.style.display = matches ? "" : "none";
    });
  }, () => {
    alert("Failed to get your location.");
  });
});
</script>
