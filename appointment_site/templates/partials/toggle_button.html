<div class="mb-3">
  <button id="toggleEarliestBtn" class="btn btn-outline-primary">
    Show All Dates
  </button>
</div>

<script>
  let showEarliestOnly = true;

  function initToggleEarliest() {
    const earliestBtn = document.getElementById("toggleEarliestBtn");

    earliestBtn?.addEventListener("click", () => {
      showEarliestOnly = !showEarliestOnly;
      earliestBtn.textContent = showEarliestOnly
        ? "Show All Dates"
        : "Show Earliest Date per Branch";
		if (typeof updateTableVisibility === "function") {
		  updateTableVisibility(showEarliestOnly);
		}
    });

    if (typeof updateTableVisibility === "function") {
      updateTableVisibility();  // Run once on load
    }
  }

  // Wait until DOM and updateTableVisibility are ready
  function waitForVisibilityAndInit() {
    if (typeof updateTableVisibility === "function") {
      initToggleEarliest();
    } else {
      setTimeout(waitForVisibilityAndInit, 50);
    }
  }

  window.addEventListener("DOMContentLoaded", waitForVisibilityAndInit);
</script>
