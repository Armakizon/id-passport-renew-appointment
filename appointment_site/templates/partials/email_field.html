<form id="notifyForm" method="POST" action="/subscribe">
  <div class="mb-3">
    <label for="email" class="form-label">Email address</label>
    <input type="email" class="form-control" id="email" name="email" required>
  </div>

  <!-- Hidden input to store activeBranchIds -->
  <input type="hidden" name="locations" id="locationsInput">
  <input type="hidden" name="fromdate" id="fromDateInput">
  <input type="hidden" name="todate" id="toDateInput">
  <button type="submit" class="btn btn-primary">Notify Me</button>
</form>

<script>
  document.getElementById("notifyForm").addEventListener("submit", function (event) {
    event.preventDefault(); // Stop default submit for now

    // Prepare values
    const activeBranchIds = window.activeBranchIds || [];
    const fromDate = document.getElementById("startDate")?.value || "";
    const toDate = document.getElementById("endDate")?.value || "";

    // Set hidden inputs
    document.getElementById("locationsInput").value = JSON.stringify(activeBranchIds);
    document.getElementById("fromDateInput").value = fromDate;
    document.getElementById("toDateInput").value = toDate;

    // Prepare a readable list of branch names or IDs - 
    // If you only have IDs, you can show IDs, or if you have names somewhere accessible, show those
    const branchList = activeBranchIds.length > 0 ? activeBranchIds.join(", ") : "no branches selected";

    // Build the confirmation message
    const message = `You successfully signed up to get notified for these branches: ${branchList} \nFrom: ${fromDate || "any date"} \nTo: ${toDate || "any date"}. Proceed?`;

    if (confirm(message)) {
      // If user confirms, submit the form programmatically
      event.target.submit();
    } else {
      // Otherwise do nothing (cancel submit)
    }
  });
</script>
